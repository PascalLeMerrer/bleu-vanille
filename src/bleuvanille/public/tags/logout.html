<logout-form>
  <div show="{ failed }" class="alert">{ errorMessage }</div>
    <span class="login">{ firstname } { lastname }</span>
    <span class="login"><a href="" onclick="{ logout }">Se déconnecter</a></span>

  <script>
  this.failed = false
  var token = null

  // Sends a disconnection request to the server
  logout() {
    superagent.post('/users/logout')
      .set('Content-Type', 'application/json; charset=UTF-8')
      .set('Authorization', 'Bearer ' + token)
      .send('')
      .end(this.logoutCallback)
  }

  // process disconnection request response
  logoutCallback(err, response) {
    if(response.ok) {
      this.logged = false
    } else {
      this.errorMessage = "La déconnexion a échoué."
      this.failed = true
    }
    riot.update()
  }
  </script>

</logout-form>
